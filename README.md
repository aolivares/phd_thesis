# Ph.D. thesis

Human body motion monitoring is a field of growing interest mainly due to the fast evolution of miniaturized inertial and magnetic sensors. The analysis of body position and motion is very important in many fields of modern medicine, teleassistance and sports performance monitoring. 
This work describes de development of a complete system to monitor the orientation of human body and the analysis of its motion using inertial (accelerometer and gyroscope) and magnetic (magnetometer a.k.a digital compass) sensors, making special emphasis in the design of algorithms to calibrate the sensors and estimate the orientation using the calibrated physical magnitudes. Along this document we describe, in first place, the employed measurement unit (Wagyromag) and the working principles of the embedded sensors as well as the procedures to analyze their quality and performance. In second place, we include an analysis of the existing calibration algorithms and we select the most well-known and efficient ones to carry out a comparative study. This study reveals the great importance of defining a complete mathematical model for the output of the sensors, as well as the necessity of employing homogeneously distributed data to estimate the calibration parameters. In addition, we propose two new algorithms to calibrate the gyroscope without using complex instrumentation. In third place, we analyze the existing possibilities to detect the intensity of the motion which is being monitored and we also carry out a comparative study between four algorithms which have already been applied to this purpose and four new alternatives. This study reveals that two of the proposed algorithms outperform the existing algorithms as they achieve up to 97\% of accuracy distinguishing between activity and inactivity. Next, we make a meticulous dissertation about the different procedures and alternatives that can be followed to estimate the attitude (orientation) of a body moving freely in space, using inertial (acceleration and angular rate) and magnetic (Earth's magnetic field) measurements. We analyze the pros and cons of every approach and explain the sensor fusion concept. We also introduce five new fusion alternatives based on variants of LMS and RLS filters, and a fusion model designed from scratch based on the Kalman filter, which precision is again analyzed by means of a comparative study. This study reveals that the accuracy of the algorithms highly depends on the initial parameters and the intensity of the motion being measured. Furthermore, we propose a new fusion strategy based on the dynamic modification of the parameters of the fusion model based on the Kalman filter so that the algorithm can be used to estimate the orientation of a body moving with changing intensity. This dynamic variant achieves a RMSE of $2.1132^{\circ}$ for the estimated orientation angles, which improves the precision of many proprietary algorithms embedded in commercial systems. Finally, we present a summary of the different fields of application in which our system can be used, making special emphasis in those applications related to healthcare.
